<!DOCTYPE html>
<html lang="en">
<head>
    <script src="objectDefaultFiles/object.js"></script>
    <script src="objectDefaultFiles/pep.min.js"></script>
    <script src="objectDefaultFiles/envelopeContents.js"></script>
    <meta charset="UTF-8">
    <title>graphUI</title>
</head>
<body style="width: 690px; height: 482px;">

<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 263.18 182.07">
    <defs>
        <style>
            @font-face {
                font-family: 'Brutal Type';
                src: url('../../sharedResources/fonts/brutal/BrutalType.otf');
                font-weight: normal;
                font-style: normal;
            }
            @font-face {
                font-family: 'Brutal Type';
                src: url('../../sharedResources/fonts/brutal/BrutalType-Bold.otf');
                font-weight: bold;
                font-style: normal;
            }
            
            #graph {
                stroke: #FEFF00;
                fill: none;
                stroke-width: 2px;
            }

            .dataFont {
                font-family: BrutalType-Bold, Brutal Type, "Avenir", "Futura", Helvetica Neue, Helvetica, Arial, sans-serif;
                font-size: 10pt;
                alignment: right;
                fill: cyan;
            }
            .cls-1 {
                opacity: 0.5;
            }

            .cls-2 {
                opacity: 0.25;
            }

            .cls-3 {
                fill: #00ffe6;
            }

            .cls-4 {
                fill: #fff;
            }
        </style>
    </defs>
    <title>Asset 4-graphUI</title>
    <g id="Layer_2" data-name="Layer 2">
        <g id="UI">
            <g>
                <g class="cls-1">
                    <rect x="3" y="3" width="257.18" height="141.85"/>
                </g>
                <g class="cls-2">
                    <path class="cls-3" d="M6.17,6.17H257V141.68H6.17V6.17M2.83,2.83V145H260.34V2.83Z"/>
                </g>
            </g>
            <path class="cls-3" d="M260.18,3V144.85H3V3H260.18m3-3H0V147.85H263.18V0Z"/>
            <g>
                <g class="cls-1">
                    <polygon points="3.78 152.94 3.78 182.07 19.03 182.07 259.34 182.07 259.34 168.19 259.34 152.94 3.78 152.94"/>
                </g>
                <path class="cls-3" d="M258.18,154.11V180.9H4.94V154.11H258.18m1.16-1.17H3.78v29.13H259.34V152.94Z"/>
            </g>
            <g class="cls-2">
                <rect class="cls-4" x="167.83" y="10.88" width="49.46" height="24.73"/>
            </g>
            <g class="cls-2">
                <rect class="cls-4" x="167.83" y="38.08" width="49.46" height="24.73"/>
            </g>
            <g class="cls-2">
                <rect class="cls-4" x="167.83" y="65.29" width="49.46" height="24.73"/>
            </g>
            <g class="cls-2">
                <rect class="cls-4" x="167.83" y="92.49" width="49.46" height="24.73"/>
            </g>
            <g class="cls-2">
                <rect class="cls-4" x="115.9" y="10.88" width="49.46" height="24.73"/>
            </g>
            <g class="cls-2">
                <rect class="cls-4" x="115.9" y="38.08" width="49.46" height="24.73"/>
            </g>
            <g class="cls-2">
                <rect class="cls-4" x="115.9" y="65.29" width="49.46" height="24.73"/>
            </g>
            <g class="cls-2">
                <rect class="cls-4" x="115.9" y="92.49" width="49.46" height="24.73"/>
            </g>
            <g class="cls-2">
                <rect class="cls-4" x="63.96" y="10.88" width="49.46" height="24.73"/>
            </g>
            <g class="cls-2">
                <rect class="cls-4" x="63.96" y="38.08" width="49.46" height="24.73"/>
            </g>
            <g class="cls-2">
                <rect class="cls-4" x="63.96" y="65.29" width="49.46" height="24.73"/>
            </g>
            <g class="cls-2">
                <rect class="cls-4" x="63.96" y="92.49" width="49.46" height="24.73"/>
            </g>
            <g class="cls-2">
                <rect class="cls-4" x="12.02" y="10.88" width="49.46" height="24.73"/>
            </g>
            <g class="cls-2">
                <rect class="cls-4" x="12.02" y="38.08" width="49.46" height="24.73"/>
            </g>
            <g class="cls-2">
                <rect class="cls-4" x="12.02" y="65.29" width="49.46" height="24.73"/>
            </g>
            <g class="cls-2">
                <rect class="cls-4" x="12.02" y="92.49" width="49.46" height="24.73"/>
            </g>
            <path class="cls-3" d="M124.79,131.89a1.24,1.24,0,0,1-.47-1h.9c0,.33.36.52.85.52.33,0,.54-.12.54-.31s-.08-.22-.24-.25l-1-.26c-.63-.16-.95-.5-.95-1,0-.73.55-1.18,1.49-1.18s1.51.46,1.54,1.26h-.91c0-.29-.26-.43-.7-.43s-.54.12-.54.29.1.21.31.26l1,.26a1,1,0,0,1,.86,1c0,.75-.6,1.2-1.53,1.2A1.76,1.76,0,0,1,124.79,131.89Z"/>
            <path class="cls-3" d="M128.62,130.91v-1.13a1.25,1.25,0,0,1,.44-1,1.75,1.75,0,0,1,1.16-.37,1.34,1.34,0,0,1,1.52,1.34v.88h-2.21v.26c0,.33.24.53.69.53s.54-.13.61-.37h.91a1.34,1.34,0,0,1-1.52,1.19C129.24,132.25,128.62,131.76,128.62,130.91Zm.91-1h1.3v-.19c0-.31-.24-.51-.65-.51s-.65.2-.65.51Z"/>
            <path class="cls-3" d="M132.86,130.9v-1.12a1.37,1.37,0,0,1,1.56-1.36,1.33,1.33,0,0,1,1.5,1.37v0H135v0a.52.52,0,0,0-.59-.54c-.43,0-.65.17-.65.51v1.15c0,.34.22.52.65.52a.52.52,0,0,0,.59-.54v-.07h.91v.05a1.28,1.28,0,0,1-.42,1,1.54,1.54,0,0,1-1.08.37C133.47,132.25,132.86,131.73,132.86,130.9Z"/>
            <path class="cls-3" d="M73.15,131.89a1.24,1.24,0,0,1-.47-1h.9c0,.33.36.52.85.52.33,0,.54-.12.54-.31s-.08-.22-.24-.25l-1-.26c-.63-.16-1-.5-1-1,0-.73.56-1.18,1.49-1.18s1.52.46,1.55,1.26h-.91c0-.29-.26-.43-.71-.43s-.53.12-.53.29.1.21.31.26l1,.26a1,1,0,0,1,.86,1c0,.75-.6,1.2-1.53,1.2A1.76,1.76,0,0,1,73.15,131.89Z"/>
            <path class="cls-3" d="M77,130.91v-1.13a1.27,1.27,0,0,1,.43-1,1.8,1.8,0,0,1,1.17-.37,1.34,1.34,0,0,1,1.52,1.34v.88H77.89v.26c0,.33.24.53.69.53s.54-.13.6-.37h.91a1.33,1.33,0,0,1-1.51,1.19C77.6,132.25,77,131.76,77,130.91Zm.91-1h1.3v-.19c0-.31-.24-.51-.65-.51s-.65.2-.65.51Z"/>
            <path class="cls-3" d="M81.22,130.9v-1.12a1.37,1.37,0,0,1,1.56-1.36,1.33,1.33,0,0,1,1.5,1.37v0h-.91v0a.52.52,0,0,0-.59-.54c-.43,0-.65.17-.65.51v1.15c0,.34.22.52.65.52a.52.52,0,0,0,.59-.54v-.07h.91v.05a1.28,1.28,0,0,1-.42,1,1.54,1.54,0,0,1-1.08.37C81.83,132.25,81.22,131.73,81.22,130.9Z"/>
            <path class="cls-3" d="M21.34,131.89a1.24,1.24,0,0,1-.47-1h.9c0,.33.36.52.85.52.33,0,.54-.12.54-.31s-.08-.22-.24-.25l-1-.26c-.63-.16-1-.5-1-1,0-.73.56-1.18,1.49-1.18s1.52.46,1.55,1.26h-.91c0-.29-.26-.43-.71-.43s-.53.12-.53.29.1.21.31.26l1,.26a1,1,0,0,1,.86,1c0,.75-.6,1.2-1.53,1.2A1.76,1.76,0,0,1,21.34,131.89Z"/>
            <path class="cls-3" d="M25.17,130.91v-1.13a1.25,1.25,0,0,1,.44-1,1.75,1.75,0,0,1,1.16-.37,1.34,1.34,0,0,1,1.52,1.34v.88H26.08v.26c0,.33.24.53.69.53s.54-.13.6-.37h.91a1.33,1.33,0,0,1-1.51,1.19C25.79,132.25,25.17,131.76,25.17,130.91Zm.91-1h1.3v-.19c0-.31-.24-.51-.65-.51s-.65.2-.65.51Z"/>
            <path class="cls-3" d="M29.41,130.9v-1.12A1.37,1.37,0,0,1,31,128.42a1.33,1.33,0,0,1,1.5,1.37v0h-.91v0a.52.52,0,0,0-.59-.54c-.43,0-.65.17-.65.51v1.15c0,.34.22.52.65.52a.52.52,0,0,0,.59-.54v-.07h.91v.05a1.28,1.28,0,0,1-.42,1,1.54,1.54,0,0,1-1.08.37C30,132.25,29.41,131.73,29.41,130.9Z"/>
            <g>
                <path class="cls-3" d="M222.2,26.82V23.16h-.48v-.48l1.16-.75h.23v4.89Z"/>
                <path class="cls-3" d="M224.55,26.82v-1h1v1Z"/>
                <path class="cls-3" d="M226.86,23.49a1.68,1.68,0,0,1,3.35,0v1.77a1.68,1.68,0,0,1-3.35,0Zm2.44,1.82V23.45a.72.72,0,0,0-.77-.8.72.72,0,0,0-.76.8v1.86a.71.71,0,0,0,.76.79A.72.72,0,0,0,229.3,25.31Z"/>
                <path class="cls-3" d="M231.51,23.49a1.68,1.68,0,0,1,3.35,0v1.77a1.68,1.68,0,0,1-3.35,0ZM234,25.31V23.45a.77.77,0,1,0-1.53,0v1.86a.77.77,0,1,0,1.53,0Z"/>
                <path class="cls-3" d="M236.17,23.49a1.68,1.68,0,0,1,3.35,0v1.77a1.68,1.68,0,0,1-3.35,0Zm2.44,1.82V23.45a.77.77,0,1,0-1.54,0v1.86a.77.77,0,1,0,1.54,0Z"/>
            </g>
            <g>
                <path class="cls-3" d="M221.9,49.94a1.68,1.68,0,0,1,3.35,0V51.7a1.68,1.68,0,1,1-3.35,0Zm2.44,1.81V49.89a.77.77,0,1,0-1.54,0v1.86a.77.77,0,1,0,1.54,0Z"/>
                <path class="cls-3" d="M226.55,53.27v-1h1v1Z"/>
                <path class="cls-3" d="M229.45,53.27v-.33l1.44-3.74h-1.42v.59h-.84V48.37h3.2v.77l-1.57,4.13Z"/>
                <path class="cls-3" d="M232.76,51.9h.89a.77.77,0,0,0,.81.65c.51,0,.77-.32.77-1s-.3-.91-.74-.91a.77.77,0,0,0-.7.37h-.88l.26-2.68h2.69v.83h-2l-.1,1a1.81,1.81,0,0,1,.87-.22,1.46,1.46,0,0,1,1.06.41,1.85,1.85,0,0,1-1.27,3A1.56,1.56,0,0,1,232.76,51.9Z"/>
                <path class="cls-3" d="M237.37,49.94a1.68,1.68,0,0,1,3.35,0V51.7a1.68,1.68,0,1,1-3.35,0Zm2.44,1.81V49.89a.73.73,0,0,0-.77-.8.72.72,0,0,0-.76.8v1.86a.72.72,0,0,0,.76.8A.72.72,0,0,0,239.81,51.75Z"/>
            </g>
            <g>
                <path class="cls-3" d="M221.9,78.1a1.68,1.68,0,0,1,3.35,0v1.77a1.68,1.68,0,0,1-3.35,0Zm2.44,1.82V78.05a.77.77,0,1,0-1.54,0v1.87a.77.77,0,1,0,1.54,0Z"/>
                <path class="cls-3" d="M226.55,81.43v-1h1v1Z"/>
                <path class="cls-3" d="M228.73,80.06h.88a.77.77,0,0,0,.82.65c.51,0,.76-.32.76-1s-.29-.9-.74-.9a.77.77,0,0,0-.7.37h-.87l.26-2.68h2.69v.82h-2l-.09,1a1.71,1.71,0,0,1,.87-.23,1.5,1.5,0,0,1,1.06.41,1.65,1.65,0,0,1,.42,1.24,1.6,1.6,0,0,1-1.69,1.79A1.56,1.56,0,0,1,228.73,80.06Z"/>
                <path class="cls-3" d="M233.34,78.1a1.68,1.68,0,0,1,3.35,0v1.77a1.68,1.68,0,0,1-3.35,0Zm2.44,1.82V78.05a.72.72,0,0,0-.77-.79.71.71,0,0,0-.76.79v1.87a.71.71,0,0,0,.76.79A.72.72,0,0,0,235.78,79.92Z"/>
                <path class="cls-3" d="M238,78.1a1.68,1.68,0,0,1,3.35,0v1.77a1.68,1.68,0,0,1-3.35,0Zm2.44,1.82V78.05a.77.77,0,1,0-1.53,0v1.87a.77.77,0,1,0,1.53,0Z"/>
            </g>
            <g>
                <path class="cls-3" d="M221.9,103.37a1.68,1.68,0,0,1,3.35,0v1.76a1.68,1.68,0,0,1-3.35,0Zm2.44,1.81v-1.86a.77.77,0,1,0-1.54,0v1.86a.77.77,0,1,0,1.54,0Z"/>
                <path class="cls-3" d="M226.55,106.7v-1h1v1Z"/>
                <path class="cls-3" d="M228.7,106.7V106l1.47-1.49a8.28,8.28,0,0,0,.67-.74.87.87,0,0,0,.15-.5.64.64,0,0,0-.68-.71c-.48,0-.72.29-.73.87h-.87a1.72,1.72,0,0,1,.44-1.24,1.56,1.56,0,0,1,1.16-.45,1.52,1.52,0,0,1,1.17.44,1.49,1.49,0,0,1,.41,1,1.53,1.53,0,0,1-.23.87,5.5,5.5,0,0,1-.8.92l-.93.89h2v.83Z"/>
                <path class="cls-3" d="M233,105.33h.89a.77.77,0,0,0,.81.65c.51,0,.77-.32.77-1s-.3-.91-.75-.91a.79.79,0,0,0-.7.37h-.87l.26-2.68h2.69v.83h-2l-.1,1a1.81,1.81,0,0,1,.87-.22,1.46,1.46,0,0,1,1.06.41,1.58,1.58,0,0,1,.43,1.24,1.6,1.6,0,0,1-1.7,1.78A1.55,1.55,0,0,1,233,105.33Z"/>
                <path class="cls-3" d="M237.58,103.37a1.68,1.68,0,0,1,3.35,0v1.76a1.68,1.68,0,0,1-3.35,0Zm2.44,1.81v-1.86a.73.73,0,0,0-.77-.8.72.72,0,0,0-.76.8v1.86a.72.72,0,0,0,.76.8A.72.72,0,0,0,240,105.18Z"/>
            </g>
            <g>
                <path class="cls-3" d="M221.9,128.84a1.68,1.68,0,0,1,3.35,0v1.76a1.68,1.68,0,1,1-3.35,0Zm2.44,1.81v-1.86a.77.77,0,1,0-1.54,0v1.86a.77.77,0,1,0,1.54,0Z"/>
                <path class="cls-3" d="M226.55,132.17v-1h1v1Z"/>
                <path class="cls-3" d="M228.85,128.84a1.68,1.68,0,0,1,3.35,0v1.76a1.68,1.68,0,1,1-3.35,0Zm2.44,1.81v-1.86a.77.77,0,1,0-1.53,0v1.86a.77.77,0,1,0,1.53,0Z"/>
                <path class="cls-3" d="M233.51,128.84a1.68,1.68,0,0,1,3.35,0v1.76a1.68,1.68,0,1,1-3.35,0Zm2.44,1.81v-1.86a.77.77,0,1,0-1.54,0v1.86a.77.77,0,1,0,1.54,0Z"/>
                <path class="cls-3" d="M238.16,128.84a1.68,1.68,0,0,1,3.35,0v1.76a1.68,1.68,0,1,1-3.35,0Zm2.44,1.81v-1.86a.77.77,0,1,0-1.53,0v1.86a.77.77,0,1,0,1.53,0Z"/>
            </g>
            <path class="cls-3" d="M174.73,131.89a1.23,1.23,0,0,1-.46-1h.9c0,.33.35.52.85.52.33,0,.54-.12.54-.31s-.08-.22-.24-.25l-1-.26c-.64-.16-1-.5-1-1,0-.73.56-1.18,1.49-1.18s1.52.46,1.55,1.26h-.91c0-.29-.26-.43-.71-.43s-.54.12-.54.29.11.21.32.26l1,.26a1,1,0,0,1,.86,1c0,.75-.6,1.2-1.53,1.2A1.81,1.81,0,0,1,174.73,131.89Z"/>
            <path class="cls-3" d="M178.57,130.91v-1.13a1.27,1.27,0,0,1,.43-1,1.79,1.79,0,0,1,1.16-.37c.93,0,1.53.5,1.53,1.34v.88h-2.21v.26c0,.33.24.53.68.53s.55-.13.61-.37h.91c-.07.75-.62,1.19-1.52,1.19S178.57,131.76,178.57,130.91Zm.91-1h1.3v-.19c0-.31-.24-.51-.65-.51s-.65.2-.65.51Z"/>
            <path class="cls-3" d="M182.81,130.9v-1.12a1.37,1.37,0,0,1,1.55-1.36,1.33,1.33,0,0,1,1.51,1.37v0H185v0c0-.33-.21-.54-.6-.54s-.64.17-.64.51v1.15c0,.34.22.52.64.52a.53.53,0,0,0,.6-.54v-.07h.91v.05a1.28,1.28,0,0,1-.42,1,1.55,1.55,0,0,1-1.09.37A1.36,1.36,0,0,1,182.81,130.9Z"/>
            <path class="cls-3" d="M168.53,132.28v-.75L170,130c.34-.36.57-.6.67-.74a.94.94,0,0,0,.14-.5.64.64,0,0,0-.68-.71c-.47,0-.72.29-.73.87h-.86a1.68,1.68,0,0,1,.44-1.24,1.54,1.54,0,0,1,1.15-.45,1.55,1.55,0,0,1,1.36,2.36,5.5,5.5,0,0,1-.8.92l-.94.9h2v.83Z"/>
            <path class="cls-3" d="M120.14,132.28v-.91H118v-.7l1.63-3.3h.79v.33l-1.39,2.85h1.09V129.4h.91v1.15h.55v.82h-.55v.91Z"/>
            <path class="cls-3" d="M66.78,131.94a1.56,1.56,0,0,1-.47-1.19,2.67,2.67,0,0,1,.48-1.4l1.25-2h.84v.33l-1,1.47a2,2,0,0,1,.42,0,1.37,1.37,0,0,1,1,.4,1.53,1.53,0,0,1,.4,1.12A1.59,1.59,0,0,1,68,132.38,1.75,1.75,0,0,1,66.78,131.94ZM68,129.87a.74.74,0,0,0-.8.84.81.81,0,1,0,1.61,0A.74.74,0,0,0,68,129.87Z"/>
            <path class="cls-3" d="M15,129.71a1.21,1.21,0,0,1-.61-1.08,1.29,1.29,0,0,1,.43-1,1.73,1.73,0,0,1,1.2-.39,1.73,1.73,0,0,1,1.2.39,1.29,1.29,0,0,1,.43,1,1.21,1.21,0,0,1-.6,1.08,1.28,1.28,0,0,1,.73,1.18c0,.92-.67,1.49-1.76,1.49s-1.76-.57-1.76-1.49A1.27,1.27,0,0,1,15,129.71Zm1,.36a.75.75,0,1,0,0,1.5.75.75,0,1,0,0-1.5Zm0-2c-.48,0-.73.26-.73.64a.73.73,0,0,0,1.46,0C16.79,128.32,16.54,128.06,16.06,128.06Z"/>
        </g>
        <g>
            <text class="dataFont" id="dataValue" x="9" y="172">0.000000</text>
        </g>
        <path id="graph"></path>
    </g>
</svg>

<script>
    var dataValue = document.querySelector('#dataValue');
    var graph = document.querySelector('#graph');

    var minY = 10.88;
    var maxY = 117.22;
    var minX = 12.02;
    var maxX = 217.29;
    
    var properties = {
        value: 0,
        unitMax: 1,
        unitMin: 0,
        unit: ""
    };
    
    var time = 60;
    var ticks = time * 2; // two seconds per box

    var min = 0;
    var max = 1;

    var isConstant = false;

    var data = [];
    var isReady = false;

    for (var i = 0; i <= ticks; i++){
        data.push(0.5); // initialize with line in middle
    }

    function renderProperties() {

        if (!isReady) {
            return;
        }
        
        function scaleVal(number) {
            return (number * (properties.unitMax-properties.unitMin))+properties.unitMin;
        }

        dataValue.textContent = scaleVal(properties.value).toPrecision(7).substring(0,8);

        if (properties.unit) {
            // dataName.textContent = properties.unit;
            dataValue.textContent = dataValue.textContent + ' ' + properties.unit;
        }

        var path = [];
        
        var prevY = 0;

        for (var i = 0; i < ticks; i++) {
            
            // var x = i * width / (ticks - 1);
            var x = minX + i * (maxX - minX) / (ticks - 1);
            
            var value = 0;
            if (i < data.length) {
                value = 1/(max-min)*(data[i]-min);
            }

            if(!value) value = 0;
            // var y = (1 - value) * height;
            var y = minY + (1 - value) * (maxY - minY);

            if(y<=0)value = 0;
            if(y>=1)value = 1;

            if (i === 0) {
                path.push('M', x, y, 'L');
                prevY = y;
            }
            
            // this makes it a square-like line instead of diagonal lines, and only adds points to path if on a corner
            if (y !== prevY) {
                path.push(x);
                path.push(prevY);

                path.push(x);
                path.push(y);
            }
            
            // ensures the line has an endpoint
            if (i === ticks-1) {
                path.push(x);
                path.push(y);
            }
            
            prevY = y;
        }

        var pathString = path.join(' ');
        graph.setAttribute('d', pathString);

        // var pathExtension = [];
        // pathExtension.push(600);
        // pathExtension.push(289);
        //
        // pathExtension.push(3);
        // pathExtension.push(289);
        // // path.push(width);
        // //path.push(height);
        // //path.push('Z');
        //
        // var pathExtensionString = pathExtension.join(' ');
        // graphBg.setAttribute('d', pathString + ' ' + pathExtensionString);
    }

    function ready() {
        isReady = true;
        renderProperties();
    }

    ready();

    var interval = setInterval(function(){
        if (isConstant && properties.value === data[data.length-1]) {
            // don't do anything
        } else {
            isConstant = false;
            data.push(properties.value);
            data.shift();
            renderProperties();
        }

    }, time);

    try {
        var realityInterface = new RealityInterface();
        var _envelopeContents = new EnvelopeContents(realityInterface, document.body);
        realityInterface.addReadListener('value', function(e) {
            properties.value = e.value;
            properties.unit = e.unit;
            properties.unitMax = e.unitMax;
            properties.unitMin = e.unitMin;
            // console.log(e);
        });
        realityInterface.setMoveDelay(10);
        // realityInterface.useSimplifiedPointerEvents();
        //  {value: 0.4565680618804775, mode: "f", unit: "volt", unitMin: 300, unitMax: 0}
    } catch (e) {
        console.warn('Reality Interface is not accessible');

        // test suite for in-browser simulation without loading in AR
        function mockReadListenerTrigger(e) {
            properties.value = e;
        }
    }
    
    function allEqual(arr) {
        return new Set(arr).size === 1;
    }

    setInterval(function() {
        if (!isConstant) {
            if (allEqual(data)) {
                isConstant = true;
            }
        }
    }, 1000); // at a low latency, check if all values are equal so we can stop wasting resources re-rendering if the values never change

</script>

</body>
</html>
